{"version":3,"sources":["../../src/middlewares/passport-jwt.js"],"names":["configureJWTStrategy","opts","jwtFromRequest","PassportJWT","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","mainConfig","secret","passport","use","Strategy","payload","done","UserModel","findOne","_id","id","err","user"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;;;AAEO,IAAMA,sDAAuB,SAAvBA,oBAAuB,GAAM;AACxC,MAAMC,OAAO,EAAb;AACAA,OAAKC,cAAL,GAAsBC,sBAAYC,UAAZ,CAAuBC,2BAAvB,EAAtB;AACAJ,OAAKK,WAAL,GAAmBC,iBAAWC,MAA9B;AACAC,qBAASC,GAAT,CACE,IAAIP,sBAAYQ,QAAhB,CAAyBV,IAAzB,EAA+B,UAACW,OAAD,EAAUC,IAAV,EAAmB;AAC9CC,mBAAUC,OAAV,CAAkB,EAAEC,KAAKJ,QAAQK,EAAf,EAAlB,EAAuC,UAACC,GAAD,EAAMC,IAAN,EAAe;AACtD,UAAID,GAAJ,EAAS;AACP,eAAOL,KAAKK,GAAL,EAAU,KAAV,CAAP;AACD;AACD,UAAIC,IAAJ,EAAU;AACR,eAAON,KAAK,IAAL,EAAWM,IAAX,CAAP;AACD;AACD,aAAON,KAAK,IAAL,EAAW,KAAX,CAAP;AACA;AACD,KATC;AAUH,GAXD,CADF;AAcD,CAlBM","file":"passport-jwt.js","sourcesContent":["import PassportJWT from 'passport-jwt';\r\nimport passport from 'passport';\r\nimport { mainConfig } from '../config/main.config';\r\nimport UserModel from '../models/user.model';\r\n\r\nexport const configureJWTStrategy = () => {\r\n  const opts = {};\r\n  opts.jwtFromRequest = PassportJWT.ExtractJwt.fromAuthHeaderAsBearerToken();\r\n  opts.secretOrKey = mainConfig.secret;\r\n  passport.use(\r\n    new PassportJWT.Strategy(opts, (payload, done) => {\r\n        UserModel.findOne({ _id: payload.id }, (err, user) => {\r\n        if (err) {\r\n          return done(err, false);\r\n        }\r\n        if (user) {\r\n          return done(null, user);\r\n        }\r\n        return done(null, false);\r\n        // or you could create a new account\r\n      });\r\n    })\r\n  );\r\n};"]}